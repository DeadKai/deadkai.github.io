<!DOCTYPE html>
<html>
<head>
    
        <link rel="alternate" type="application/rss+xml" title="RSS" href="https://deadkai.github.io/atom.xml">
    
    
    
        
    
    
    
    
    
    
        
        
    
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
    <title>title</title>
    <meta charset="utf-8">
    <meta name="title" content="title">
    <meta name="description" content="">
    <meta property="og:image:width" content="200" />
    <meta property="og:image:height" content="200" />
    <link rel="stylesheet" href="https:&#x2F;&#x2F;deadkai.github.io/style.css">
    
    <link rel="stylesheet" href="https:&#x2F;&#x2F;deadkai.github.io/autodarkmode.css">
    
    
    <style>
    @media screen and (min-width: 320px) {
        body {
            font-size: calc(16px + 2 * ((100vw - 320px) / 960));
        }
    }
    </style>
    
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Source+Serif+Pro:wght@400;700&display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;700&amp;family=Noto+Serif+KR:wght@400;700&amp;Noto+Serif+SC:wght@400;700&display=swap">
    <style>body { font-family: 'Source Serif Pro', 'Source Han Serif TC', 'Noto Serif CJK TC', 'Noto Serif TC', 'Noto Serif KR', 'Noto Serif SC', serif }</style>
    

    <!-- MathJax Latex Support Script-->
    

</head>
<body>
    
    <header class="header">
        <div class="blog-title"><a href="https:&#x2F;&#x2F;deadkai.github.io" class="logo">title</a></div>
        <nav class="navbar">
    <ul class="menu">
        
        
        <li class="menu-item">
            
            
            
            
            <a href="https:&#x2F;&#x2F;deadkai.github.io&#x2F;" class="current-menu-item-link">home</a>
            
        </li>
        
        <li class="menu-item">
            
            
            
            
            <a href="https:&#x2F;&#x2F;deadkai.github.io&#x2F;archives" class="menu-item-link">archives</a>
            
        </li>
        
        <li class="menu-item">
            
            
            
            
            <a href="https:&#x2F;&#x2F;deadkai.github.io&#x2F;about" class="menu-item-link">about</a>
            
        </li>
        
    </ul>
</nav>

    </header>
    
    <main class="main">
        
<section class="posts">
    
    <article class="post">
        <div class="post-title"><a href="https:&#x2F;&#x2F;deadkai.github.io&#x2F;python-async-programming&#x2F;" class="post-title-link">Async Programming in Python: A Practical Guide</a></div>
        <div class="post-content">
            
                
                    <p>Asynchronous programming in Python has evolved significantly with the introduction of <code>async</code> and <code>await</code> keywords. Understanding when and how to use async can dramatically improve your application's performance.</p>
<h2 id="what-is-async-programming">What is Async Programming?</h2>
<p>Async programming allows your program to handle multiple operations concurrently without using multiple threads. This is particularly valuable for I/O-bound operations like:</p>
<ul>
<li>Network requests</li>
<li>Database queries</li>
<li>File operations</li>
<li>API calls</li>
</ul>
<h2 id="sync-vs-async-a-simple-example">Sync vs Async: A Simple Example</h2>
<h3 id="synchronous-code">Synchronous Code</h3>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#b48ead;">import </span><span>time
</span><span style="color:#b48ead;">import </span><span>requests
</span><span>
</span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">fetch_url</span><span>(</span><span style="color:#bf616a;">url</span><span>):
</span><span>    response = requests.</span><span style="color:#bf616a;">get</span><span>(url)
</span><span>    </span><span style="color:#b48ead;">return </span><span>response.text
</span><span>
</span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">main</span><span>():
</span><span>    urls = [&#39;</span><span style="color:#a3be8c;">https://api.example.com/1</span><span>&#39;, &#39;</span><span style="color:#a3be8c;">https://api.example.com/2</span><span>&#39;]
</span><span>    start = time.</span><span style="color:#bf616a;">time</span><span>()
</span><span>
</span><span>    </span><span style="color:#b48ead;">for </span><span>url </span><span style="color:#b48ead;">in </span><span>urls:
</span><span>        data = </span><span style="color:#bf616a;">fetch_url</span><span>(url)
</span><span>        </span><span style="color:#96b5b4;">print</span><span>(</span><span style="color:#b48ead;">f</span><span>&quot;</span><span style="color:#a3be8c;">Fetched </span><span>{</span><span style="color:#96b5b4;">len</span><span>(data)}</span><span style="color:#a3be8c;"> bytes</span><span>&quot;)
</span><span>
</span><span>    </span><span style="color:#96b5b4;">print</span><span>(</span><span style="color:#b48ead;">f</span><span>&quot;</span><span style="color:#a3be8c;">Time taken: </span><span>{time.</span><span style="color:#bf616a;">time</span><span>() - start</span><span style="color:#d08770;">:.2f</span><span>}</span><span style="color:#a3be8c;">s</span><span>&quot;)
</span><span>
</span><span style="color:#65737e;"># Time taken: ~4.0s (2 seconds per request)
</span></code></pre>
<h3 id="asynchronous-code">Asynchronous Code</h3>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#b48ead;">import </span><span>asyncio
</span><span style="color:#b48ead;">import </span><span>aiohttp
</span><span style="color:#b48ead;">import </span><span>time
</span><span>
</span><span style="color:#b48ead;">async def </span><span style="color:#8fa1b3;">fetch_url</span><span>(</span><span style="color:#bf616a;">session</span><span>, </span><span style="color:#bf616a;">url</span><span>):
</span><span>    </span><span style="color:#b48ead;">async with </span><span>session.</span><span style="color:#bf616a;">get</span><span>(url) </span><span style="color:#b48ead;">as </span><span>response:
</span><span>        </span><span style="color:#b48ead;">return await </span><span>response.</span><span style="color:#bf616a;">text</span><span>()
</span><span>
</span><span style="color:#b48ead;">async def </span><span style="color:#8fa1b3;">main</span><span>():
</span><span>    urls = [&#39;</span><span style="color:#a3be8c;">https://api.example.com/1</span><span>&#39;, &#39;</span><span style="color:#a3be8c;">https://api.example.com/2</span><span>&#39;]
</span><span>    start = time.</span><span style="color:#bf616a;">time</span><span>()
</span><span>
</span><span>    </span><span style="color:#b48ead;">async with </span><span>aiohttp.</span><span style="color:#bf616a;">ClientSession</span><span>() </span><span style="color:#b48ead;">as </span><span>session:
</span><span>        tasks = [</span><span style="color:#bf616a;">fetch_url</span><span>(session, url) </span><span style="color:#b48ead;">for </span><span>url </span><span style="color:#b48ead;">in </span><span>urls]
</span><span>        results = </span><span style="color:#b48ead;">await </span><span>asyncio.</span><span style="color:#bf616a;">gather</span><span>(*tasks)
</span><span>
</span><span>        </span><span style="color:#b48ead;">for </span><span>data </span><span style="color:#b48ead;">in </span><span>results:
</span><span>            </span><span style="color:#96b5b4;">print</span><span>(</span><span style="color:#b48ead;">f</span><span>&quot;</span><span style="color:#a3be8c;">Fetched </span><span>{</span><span style="color:#96b5b4;">len</span><span>(data)}</span><span style="color:#a3be8c;"> bytes</span><span>&quot;)
</span><span>
</span><span>    </span><span style="color:#96b5b4;">print</span><span>(</span><span style="color:#b48ead;">f</span><span>&quot;</span><span style="color:#a3be8c;">Time taken: </span><span>{time.</span><span style="color:#bf616a;">time</span><span>() - start</span><span style="color:#d08770;">:.2f</span><span>}</span><span style="color:#a3be8c;">s</span><span>&quot;)
</span><span>
</span><span>asyncio.</span><span style="color:#bf616a;">run</span><span>(</span><span style="color:#bf616a;">main</span><span>())
</span><span style="color:#65737e;"># Time taken: ~2.0s (requests happen concurrently!)
</span></code></pre>
<p>The async version completes in half the time because requests run concurrently.</p>
<h2 id="core-concepts">Core Concepts</h2>
<h3 id="coroutines">Coroutines</h3>
<p>Functions defined with <code>async def</code> are coroutines. They don't execute immediately when called—they return a coroutine object:</p>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#b48ead;">async def </span><span style="color:#8fa1b3;">greet</span><span>(</span><span style="color:#bf616a;">name</span><span>):
</span><span>    </span><span style="color:#b48ead;">return f</span><span>&quot;</span><span style="color:#a3be8c;">Hello, </span><span>{name}&quot;
</span><span>
</span><span style="color:#65737e;"># This doesn&#39;t print anything:
</span><span>coro = </span><span style="color:#bf616a;">greet</span><span>(&quot;</span><span style="color:#a3be8c;">Alice</span><span>&quot;)
</span><span>
</span><span style="color:#65737e;"># This executes the coroutine:
</span><span>result = </span><span style="color:#b48ead;">await </span><span style="color:#bf616a;">greet</span><span>(&quot;</span><span style="color:#a3be8c;">Alice</span><span>&quot;)  </span><span style="color:#65737e;"># Must be inside async function
</span></code></pre>
<h3 id="the-event-loop">The Event Loop</h3>
<p>The event loop manages and executes async tasks. It's the core of async programming:</p>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#65737e;"># Python 3.7+
</span><span>asyncio.</span><span style="color:#bf616a;">run</span><span>(</span><span style="color:#bf616a;">main</span><span>())
</span><span>
</span><span style="color:#65737e;"># Older approach
</span><span>loop = asyncio.</span><span style="color:#bf616a;">get_event_loop</span><span>()
</span><span>loop.</span><span style="color:#bf616a;">run_until_complete</span><span>(</span><span style="color:#bf616a;">main</span><span>())
</span><span>loop.</span><span style="color:#bf616a;">close</span><span>()
</span></code></pre>
<h3 id="await-keyword">await Keyword</h3>
<p><code>await</code> pauses the coroutine until the awaited operation completes, allowing other coroutines to run:</p>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#b48ead;">async def </span><span style="color:#8fa1b3;">process_data</span><span>():
</span><span>    data = </span><span style="color:#b48ead;">await </span><span style="color:#bf616a;">fetch_data</span><span>()  </span><span style="color:#65737e;"># Waits here
</span><span>    result = </span><span style="color:#b48ead;">await </span><span style="color:#bf616a;">transform_data</span><span>(data)  </span><span style="color:#65737e;"># Then waits here
</span><span>    </span><span style="color:#b48ead;">return </span><span>result
</span></code></pre>
<h3 id="creating-tasks">Creating Tasks</h3>
<p>Tasks allow coroutines to run concurrently:</p>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#b48ead;">async def </span><span style="color:#8fa1b3;">main</span><span>():
</span><span>    </span><span style="color:#65737e;"># These run concurrently
</span><span>    task1 = asyncio.</span><span style="color:#bf616a;">create_task</span><span>(</span><span style="color:#bf616a;">fetch_data</span><span>(</span><span style="color:#d08770;">1</span><span>))
</span><span>    task2 = asyncio.</span><span style="color:#bf616a;">create_task</span><span>(</span><span style="color:#bf616a;">fetch_data</span><span>(</span><span style="color:#d08770;">2</span><span>))
</span><span>
</span><span>    result1 = </span><span style="color:#b48ead;">await </span><span>task1
</span><span>    result2 = </span><span style="color:#b48ead;">await </span><span>task2
</span></code></pre>
<h2 id="common-patterns">Common Patterns</h2>
<h3 id="gathering-multiple-coroutines">Gathering Multiple Coroutines</h3>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#b48ead;">async def </span><span style="color:#8fa1b3;">main</span><span>():
</span><span>    results = </span><span style="color:#b48ead;">await </span><span>asyncio.</span><span style="color:#bf616a;">gather</span><span>(
</span><span>        </span><span style="color:#bf616a;">fetch_data</span><span>(</span><span style="color:#d08770;">1</span><span>),
</span><span>        </span><span style="color:#bf616a;">fetch_data</span><span>(</span><span style="color:#d08770;">2</span><span>),
</span><span>        </span><span style="color:#bf616a;">fetch_data</span><span>(</span><span style="color:#d08770;">3</span><span>)
</span><span>    )
</span><span>    </span><span style="color:#65737e;"># All three run concurrently
</span><span>    </span><span style="color:#96b5b4;">print</span><span>(results)  </span><span style="color:#65737e;"># [result1, result2, result3]
</span></code></pre>
<h3 id="handling-timeouts">Handling Timeouts</h3>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#b48ead;">async def </span><span style="color:#8fa1b3;">fetch_with_timeout</span><span>(</span><span style="color:#bf616a;">url</span><span>):
</span><span>    </span><span style="color:#b48ead;">try</span><span>:
</span><span>        </span><span style="color:#b48ead;">async with </span><span>aiohttp.</span><span style="color:#bf616a;">ClientSession</span><span>() </span><span style="color:#b48ead;">as </span><span>session:
</span><span>            </span><span style="color:#b48ead;">async with </span><span>asyncio.</span><span style="color:#bf616a;">timeout</span><span>(</span><span style="color:#d08770;">5.0</span><span>):  </span><span style="color:#65737e;"># Python 3.11+
</span><span>                response = </span><span style="color:#b48ead;">await </span><span>session.</span><span style="color:#bf616a;">get</span><span>(url)
</span><span>                </span><span style="color:#b48ead;">return await </span><span>response.</span><span style="color:#bf616a;">text</span><span>()
</span><span>    </span><span style="color:#b48ead;">except </span><span>asyncio.TimeoutError:
</span><span>        </span><span style="color:#b48ead;">return </span><span style="color:#d08770;">None
</span></code></pre>
<h3 id="running-background-tasks">Running Background Tasks</h3>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#b48ead;">async def </span><span style="color:#8fa1b3;">background_task</span><span>():
</span><span>    </span><span style="color:#b48ead;">while </span><span style="color:#d08770;">True</span><span>:
</span><span>        </span><span style="color:#b48ead;">await </span><span>asyncio.</span><span style="color:#bf616a;">sleep</span><span>(</span><span style="color:#d08770;">60</span><span>)
</span><span>        </span><span style="color:#b48ead;">await </span><span style="color:#bf616a;">cleanup_old_data</span><span>()
</span><span>
</span><span style="color:#b48ead;">async def </span><span style="color:#8fa1b3;">main</span><span>():
</span><span>    </span><span style="color:#65737e;"># Start background task
</span><span>    task = asyncio.</span><span style="color:#bf616a;">create_task</span><span>(</span><span style="color:#bf616a;">background_task</span><span>())
</span><span>
</span><span>    </span><span style="color:#65737e;"># Do other work
</span><span>    </span><span style="color:#b48ead;">await </span><span style="color:#bf616a;">handle_requests</span><span>()
</span><span>
</span><span>    </span><span style="color:#65737e;"># Cancel background task when done
</span><span>    task.</span><span style="color:#bf616a;">cancel</span><span>()
</span></code></pre>
<h3 id="async-context-managers">Async Context Managers</h3>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#b48ead;">class </span><span style="color:#ebcb8b;">AsyncDatabase</span><span style="color:#eff1f5;">:
</span><span>    </span><span style="color:#b48ead;">async def </span><span style="color:#96b5b4;">__aenter__</span><span>(</span><span style="color:#bf616a;">self</span><span>):
</span><span>        </span><span style="color:#bf616a;">self</span><span>.connection = </span><span style="color:#b48ead;">await </span><span style="color:#bf616a;">create_connection</span><span>()
</span><span>        </span><span style="color:#b48ead;">return </span><span style="color:#bf616a;">self
</span><span>
</span><span>    </span><span style="color:#b48ead;">async def </span><span style="color:#96b5b4;">__aexit__</span><span>(</span><span style="color:#bf616a;">self</span><span>, </span><span style="color:#bf616a;">exc_type</span><span>, </span><span style="color:#bf616a;">exc_val</span><span>, </span><span style="color:#bf616a;">exc_tb</span><span>):
</span><span>        </span><span style="color:#b48ead;">await </span><span style="color:#bf616a;">self</span><span>.connection.</span><span style="color:#bf616a;">close</span><span>()
</span><span>
</span><span style="color:#b48ead;">async def </span><span style="color:#8fa1b3;">main</span><span>():
</span><span>    </span><span style="color:#b48ead;">async with </span><span style="color:#bf616a;">AsyncDatabase</span><span>() </span><span style="color:#b48ead;">as </span><span>db:
</span><span>        data = </span><span style="color:#b48ead;">await </span><span>db.</span><span style="color:#bf616a;">query</span><span>(&quot;</span><span style="color:#b48ead;">SELECT </span><span style="color:#bf616a;">* </span><span style="color:#b48ead;">FROM</span><span style="color:#a3be8c;"> users</span><span>&quot;)
</span></code></pre>
<h2 id="common-pitfalls">Common Pitfalls</h2>
<h3 id="blocking-the-event-loop">Blocking the Event Loop</h3>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#65737e;"># BAD: This blocks the entire event loop
</span><span style="color:#b48ead;">async def </span><span style="color:#8fa1b3;">bad_sleep</span><span>():
</span><span>    time.</span><span style="color:#bf616a;">sleep</span><span>(</span><span style="color:#d08770;">5</span><span>)  </span><span style="color:#65737e;"># Blocks everything!
</span><span>
</span><span style="color:#65737e;"># GOOD: Use async sleep
</span><span style="color:#b48ead;">async def </span><span style="color:#8fa1b3;">good_sleep</span><span>():
</span><span>    </span><span style="color:#b48ead;">await </span><span>asyncio.</span><span style="color:#bf616a;">sleep</span><span>(</span><span style="color:#d08770;">5</span><span>)  </span><span style="color:#65737e;"># Allows other tasks to run
</span></code></pre>
<h3 id="forgetting-to-await">Forgetting to await</h3>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#65737e;"># BAD: Coroutine never executes
</span><span style="color:#b48ead;">async def </span><span style="color:#8fa1b3;">process</span><span>():
</span><span>    </span><span style="color:#bf616a;">fetch_data</span><span>()  </span><span style="color:#65737e;"># Missing await!
</span><span>
</span><span style="color:#65737e;"># GOOD
</span><span style="color:#b48ead;">async def </span><span style="color:#8fa1b3;">process</span><span>():
</span><span>    </span><span style="color:#b48ead;">await </span><span style="color:#bf616a;">fetch_data</span><span>()
</span></code></pre>
<h3 id="mixing-sync-and-async">Mixing Sync and Async</h3>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#65737e;"># BAD: Can&#39;t use await outside async function
</span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">sync_function</span><span>():
</span><span>    result = </span><span style="color:#b48ead;">await </span><span style="color:#bf616a;">async_function</span><span>()  </span><span style="color:#65737e;"># SyntaxError!
</span><span>
</span><span style="color:#65737e;"># GOOD: Use asyncio.run() or make function async
</span><span style="color:#b48ead;">async def </span><span style="color:#8fa1b3;">async_function_caller</span><span>():
</span><span>    result = </span><span style="color:#b48ead;">await </span><span style="color:#bf616a;">async_function</span><span>()
</span></code></pre>
<h2 id="when-to-use-async">When to Use Async</h2>
<h3 id="good-use-cases">Good Use Cases</h3>
<ul>
<li><strong>I/O-bound operations</strong>: Network requests, database queries, file operations</li>
<li><strong>Many concurrent operations</strong>: Handling hundreds of simultaneous connections</li>
<li><strong>Real-time applications</strong>: WebSockets, chat servers, streaming</li>
</ul>
<h3 id="bad-use-cases">Bad Use Cases</h3>
<ul>
<li><strong>CPU-bound operations</strong>: Heavy computation, image processing, data crunching</li>
<li><strong>Simple scripts</strong>: Async adds complexity for minimal benefit</li>
<li><strong>Legacy codebases</strong>: Retrofitting async can be challenging</li>
</ul>
<p>For CPU-bound tasks, use <code>multiprocessing</code> instead:</p>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#b48ead;">from </span><span>multiprocessing </span><span style="color:#b48ead;">import </span><span>Pool
</span><span>
</span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">cpu_intensive</span><span>(</span><span style="color:#bf616a;">n</span><span>):
</span><span>    </span><span style="color:#b48ead;">return </span><span style="color:#96b5b4;">sum</span><span>(i*i </span><span style="color:#b48ead;">for </span><span>i </span><span style="color:#b48ead;">in </span><span style="color:#96b5b4;">range</span><span>(n))
</span><span>
</span><span style="color:#b48ead;">with </span><span style="color:#bf616a;">Pool</span><span>(</span><span style="color:#d08770;">4</span><span>) </span><span style="color:#b48ead;">as </span><span>p:
</span><span>    results = p.</span><span style="color:#bf616a;">map</span><span>(cpu_intensive, [</span><span style="color:#d08770;">10</span><span>**</span><span style="color:#d08770;">7</span><span>, </span><span style="color:#d08770;">10</span><span>**</span><span style="color:#d08770;">7</span><span>, </span><span style="color:#d08770;">10</span><span>**</span><span style="color:#d08770;">7</span><span>, </span><span style="color:#d08770;">10</span><span>**</span><span style="color:#d08770;">7</span><span>])
</span></code></pre>
<h2 id="real-world-example-web-scraper">Real-World Example: Web Scraper</h2>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#b48ead;">import </span><span>asyncio
</span><span style="color:#b48ead;">import </span><span>aiohttp
</span><span style="color:#b48ead;">from </span><span>bs4 </span><span style="color:#b48ead;">import </span><span>BeautifulSoup
</span><span>
</span><span style="color:#b48ead;">async def </span><span style="color:#8fa1b3;">fetch_page</span><span>(</span><span style="color:#bf616a;">session</span><span>, </span><span style="color:#bf616a;">url</span><span>):
</span><span>    </span><span style="color:#b48ead;">async with </span><span>session.</span><span style="color:#bf616a;">get</span><span>(url) </span><span style="color:#b48ead;">as </span><span>response:
</span><span>        </span><span style="color:#b48ead;">return await </span><span>response.</span><span style="color:#bf616a;">text</span><span>()
</span><span>
</span><span style="color:#b48ead;">async def </span><span style="color:#8fa1b3;">parse_page</span><span>(</span><span style="color:#bf616a;">html</span><span>):
</span><span>    soup = </span><span style="color:#bf616a;">BeautifulSoup</span><span>(html, &#39;</span><span style="color:#a3be8c;">html.parser</span><span>&#39;)
</span><span>    </span><span style="color:#b48ead;">return </span><span>soup.</span><span style="color:#bf616a;">find_all</span><span>(&#39;</span><span style="color:#a3be8c;">a</span><span>&#39;, </span><span style="color:#bf616a;">href</span><span>=</span><span style="color:#d08770;">True</span><span>)
</span><span>
</span><span style="color:#b48ead;">async def </span><span style="color:#8fa1b3;">scrape_site</span><span>(</span><span style="color:#bf616a;">urls</span><span>):
</span><span>    </span><span style="color:#b48ead;">async with </span><span>aiohttp.</span><span style="color:#bf616a;">ClientSession</span><span>() </span><span style="color:#b48ead;">as </span><span>session:
</span><span>        tasks = [</span><span style="color:#bf616a;">fetch_page</span><span>(session, url) </span><span style="color:#b48ead;">for </span><span>url </span><span style="color:#b48ead;">in </span><span>urls]
</span><span>        pages = </span><span style="color:#b48ead;">await </span><span>asyncio.</span><span style="color:#bf616a;">gather</span><span>(*tasks)
</span><span>
</span><span>        all_links = []
</span><span>        </span><span style="color:#b48ead;">for </span><span>html </span><span style="color:#b48ead;">in </span><span>pages:
</span><span>            links = </span><span style="color:#b48ead;">await </span><span style="color:#bf616a;">parse_page</span><span>(html)
</span><span>            all_links.</span><span style="color:#bf616a;">extend</span><span>(links)
</span><span>
</span><span>        </span><span style="color:#b48ead;">return </span><span>all_links
</span><span>
</span><span>urls = [</span><span style="color:#b48ead;">f</span><span>&#39;</span><span style="color:#a3be8c;">https://example.com/page</span><span>{i}&#39; </span><span style="color:#b48ead;">for </span><span>i </span><span style="color:#b48ead;">in </span><span style="color:#96b5b4;">range</span><span>(</span><span style="color:#d08770;">10</span><span>)]
</span><span>links = asyncio.</span><span style="color:#bf616a;">run</span><span>(</span><span style="color:#bf616a;">scrape_site</span><span>(urls))
</span><span style="color:#96b5b4;">print</span><span>(</span><span style="color:#b48ead;">f</span><span>&quot;</span><span style="color:#a3be8c;">Found </span><span>{</span><span style="color:#96b5b4;">len</span><span>(links)}</span><span style="color:#a3be8c;"> links</span><span>&quot;)
</span></code></pre>
<h2 id="conclusion">Conclusion</h2>
<p>Async programming in Python is powerful but not a silver bullet. Key takeaways:</p>
<ul>
<li>Use async for I/O-bound operations</li>
<li>Understand the event loop and how it schedules coroutines</li>
<li>Always <code>await</code> your coroutines</li>
<li>Don't block the event loop with synchronous code</li>
<li>Consider whether the complexity is worth it for your use case</li>
</ul>
<p>When used appropriately, async can dramatically improve application performance and responsiveness. Start with simple examples, understand the fundamentals, and gradually incorporate async patterns where they provide clear benefits.</p>

                
            
        </div>
    </article>
    
    <article class="post">
        <div class="post-title"><a href="https:&#x2F;&#x2F;deadkai.github.io&#x2F;system-design-basics&#x2F;" class="post-title-link">System Design Fundamentals: Building Scalable Applications</a></div>
        <div class="post-content">
            
                
                    <p>System design is the art of building applications that can scale to millions of users while remaining reliable, maintainable, and cost-effective. Whether you're preparing for interviews or building production systems, understanding these fundamentals is essential.</p>
<h2 id="key-principles">Key Principles</h2>
<h3 id="1-scalability">1. Scalability</h3>
<p>The ability to handle increased load by adding resources. Two types exist:</p>
<p><strong>Vertical Scaling (Scale Up)</strong></p>
<ul>
<li>Add more power to existing machines (CPU, RAM, disk)</li>
<li>Simpler to implement</li>
<li>Limited by hardware constraints</li>
<li>Single point of failure</li>
</ul>
<p><strong>Horizontal Scaling (Scale Out)</strong></p>
<ul>
<li>Add more machines to the pool</li>
<li>Better fault tolerance</li>
<li>More complex architecture</li>
<li>Nearly unlimited scaling potential</li>
</ul>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>Vertical: 1 server with 32GB RAM
</span><span>Horizontal: 8 servers with 4GB RAM each
</span></code></pre>
<h3 id="2-availability">2. Availability</h3>
<p>The percentage of time a system is operational. Measured in &quot;nines&quot;:</p>
<ul>
<li>99% = 3.65 days downtime/year</li>
<li>99.9% = 8.76 hours downtime/year</li>
<li>99.99% = 52.6 minutes downtime/year</li>
<li>99.999% = 5.26 minutes downtime/year</li>
</ul>
<p>Achieve high availability through:</p>
<ul>
<li>Redundancy (multiple instances)</li>
<li>Failover mechanisms</li>
<li>Health checks and monitoring</li>
<li>Geographic distribution</li>
</ul>
<h3 id="3-reliability">3. Reliability</h3>
<p>The probability that a system will produce correct outputs. Key strategies:</p>
<ul>
<li><strong>Replication</strong>: Multiple copies of data</li>
<li><strong>Checksums</strong>: Verify data integrity</li>
<li><strong>Monitoring</strong>: Detect issues early</li>
<li><strong>Graceful degradation</strong>: Maintain core functionality during failures</li>
</ul>
<h2 id="core-components">Core Components</h2>
<h3 id="load-balancers">Load Balancers</h3>
<p>Distribute traffic across multiple servers:</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>                    [Load Balancer]
</span><span>                    /      |      \
</span><span>            [Server 1] [Server 2] [Server 3]
</span></code></pre>
<p>Common algorithms:</p>
<ul>
<li><strong>Round Robin</strong>: Cycle through servers sequentially</li>
<li><strong>Least Connections</strong>: Send to server with fewest active connections</li>
<li><strong>IP Hash</strong>: Route based on client IP</li>
<li><strong>Weighted</strong>: Assign capacity weights to servers</li>
</ul>
<h3 id="caching">Caching</h3>
<p>Store frequently accessed data in faster storage:</p>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#65737e;"># Without cache: ~100ms database query
</span><span>user = database.</span><span style="color:#bf616a;">query</span><span>(&quot;</span><span style="color:#b48ead;">SELECT </span><span style="color:#bf616a;">* </span><span style="color:#b48ead;">FROM</span><span style="color:#a3be8c;"> users </span><span style="color:#b48ead;">WHERE</span><span style="color:#a3be8c;"> id</span><span>=</span><span style="color:#a3be8c;">?</span><span>&quot;, user_id)
</span><span>
</span><span style="color:#65737e;"># With cache: ~1ms memory lookup
</span><span>user = cache.</span><span style="color:#bf616a;">get</span><span>(</span><span style="color:#b48ead;">f</span><span>&quot;</span><span style="color:#a3be8c;">user:</span><span>{user_id}&quot;)
</span><span style="color:#b48ead;">if </span><span>not user:
</span><span>    user = database.</span><span style="color:#bf616a;">query</span><span>(&quot;</span><span style="color:#b48ead;">SELECT </span><span style="color:#bf616a;">* </span><span style="color:#b48ead;">FROM</span><span style="color:#a3be8c;"> users </span><span style="color:#b48ead;">WHERE</span><span style="color:#a3be8c;"> id</span><span>=</span><span style="color:#a3be8c;">?</span><span>&quot;, user_id)
</span><span>    cache.</span><span style="color:#bf616a;">set</span><span>(</span><span style="color:#b48ead;">f</span><span>&quot;</span><span style="color:#a3be8c;">user:</span><span>{user_id}&quot;, user, </span><span style="color:#bf616a;">ttl</span><span>=</span><span style="color:#d08770;">3600</span><span>)
</span></code></pre>
<p>Caching strategies:</p>
<ul>
<li><strong>Cache-Aside</strong>: Application manages cache</li>
<li><strong>Write-Through</strong>: Write to cache and database simultaneously</li>
<li><strong>Write-Back</strong>: Write to cache, async write to database</li>
<li><strong>Refresh-Ahead</strong>: Proactively refresh before expiration</li>
</ul>
<h3 id="databases">Databases</h3>
<h4 id="sql-vs-nosql">SQL vs NoSQL</h4>
<p><strong>SQL (PostgreSQL, MySQL)</strong></p>
<ul>
<li>Structured schema</li>
<li>ACID transactions</li>
<li>Complex queries with JOINs</li>
<li>Vertical scaling primarily</li>
<li>Use for: Financial data, user accounts, structured relationships</li>
</ul>
<p><strong>NoSQL (MongoDB, Cassandra, DynamoDB)</strong></p>
<ul>
<li>Flexible schema</li>
<li>BASE model (eventual consistency)</li>
<li>Simple query patterns</li>
<li>Horizontal scaling</li>
<li>Use for: Logs, sessions, real-time analytics, unstructured data</li>
</ul>
<h4 id="database-sharding">Database Sharding</h4>
<p>Split data across multiple databases:</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>Users 1-1M    → Shard 1
</span><span>Users 1M-2M   → Shard 2
</span><span>Users 2M-3M   → Shard 3
</span></code></pre>
<p>Sharding strategies:</p>
<ul>
<li><strong>Range-based</strong>: Shard by ID ranges</li>
<li><strong>Hash-based</strong>: Hash user ID to determine shard</li>
<li><strong>Geographic</strong>: Shard by user location</li>
<li><strong>Directory-based</strong>: Lookup table maps entities to shards</li>
</ul>
<h3 id="message-queues">Message Queues</h3>
<p>Decouple services and handle asynchronous processing:</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>[API] → [Queue] → [Worker 1]
</span><span>                → [Worker 2]
</span><span>                → [Worker 3]
</span></code></pre>
<p>Benefits:</p>
<ul>
<li>Asynchronous processing</li>
<li>Load smoothing</li>
<li>Fault tolerance</li>
<li>Retry mechanisms</li>
</ul>
<p>Popular options: RabbitMQ, Apache Kafka, AWS SQS, Redis</p>
<h3 id="cdn-content-delivery-network">CDN (Content Delivery Network)</h3>
<p>Distribute static content globally:</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>User in Tokyo → Tokyo CDN node (10ms)
</span><span>Instead of:
</span><span>User in Tokyo → US origin server (200ms)
</span></code></pre>
<p>Cache:</p>
<ul>
<li>Images, CSS, JavaScript</li>
<li>Videos and audio</li>
<li>Static HTML pages</li>
<li>API responses (with proper headers)</li>
</ul>
<h2 id="design-patterns">Design Patterns</h2>
<h3 id="api-gateway">API Gateway</h3>
<p>Single entry point for all client requests:</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>[Mobile App]  \
</span><span>[Web App]     → [API Gateway] → [Microservices]
</span><span>[3rd Party]   /
</span></code></pre>
<p>Responsibilities:</p>
<ul>
<li>Authentication/authorization</li>
<li>Rate limiting</li>
<li>Request routing</li>
<li>Response transformation</li>
<li>Monitoring and logging</li>
</ul>
<h3 id="microservices-vs-monolith">Microservices vs Monolith</h3>
<p><strong>Monolith</strong></p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>[Single Application]
</span><span>- User Management
</span><span>- Order Processing
</span><span>- Payment
</span><span>- Inventory
</span></code></pre>
<p>Pros: Simple deployment, easier debugging, no network overhead
Cons: Hard to scale specific features, technology lock-in</p>
<p><strong>Microservices</strong></p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>[User Service] [Order Service] [Payment Service] [Inventory Service]
</span></code></pre>
<p>Pros: Independent scaling, technology flexibility, team autonomy
Cons: Complex deployment, network overhead, distributed debugging</p>
<h3 id="event-driven-architecture">Event-Driven Architecture</h3>
<p>Services communicate through events:</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>[Order Service] → Event: OrderCreated → [Email Service]
</span><span>                                      → [Inventory Service]
</span><span>                                      → [Analytics Service]
</span></code></pre>
<p>Benefits:</p>
<ul>
<li>Loose coupling</li>
<li>Easy to add new consumers</li>
<li>Natural async processing</li>
<li>Event replay for debugging</li>
</ul>
<h2 id="real-world-example-instagram-like-app">Real-World Example: Instagram-Like App</h2>
<p>Let's design a simplified photo-sharing platform:</p>
<h3 id="requirements">Requirements</h3>
<ul>
<li>Upload and view photos</li>
<li>Follow users</li>
<li>News feed</li>
<li>Like and comment</li>
<li>100M users, 50M daily active</li>
</ul>
<h3 id="high-level-design">High-Level Design</h3>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>[CDN] ← Static content (images)
</span><span>  ↑
</span><span>[Load Balancer]
</span><span>  ↓
</span><span>[API Servers (stateless)]
</span><span>  ↓
</span><span>[Cache Layer (Redis)]
</span><span>  ↓
</span><span>[Database Cluster]
</span><span>  - User DB (PostgreSQL - sharded by user_id)
</span><span>  - Photo DB (PostgreSQL - sharded by photo_id)
</span><span>  - Feed DB (Cassandra - timeline data)
</span><span>
</span><span>[Object Storage (S3)]
</span><span>  - Original photos
</span><span>  - Processed photos (thumbnails, etc.)
</span><span>
</span><span>[Message Queue (Kafka)]
</span><span>  - Photo processing jobs
</span><span>  - Feed fanout jobs
</span><span>  - Notification jobs
</span></code></pre>
<h3 id="key-decisions">Key Decisions</h3>
<p><strong>Photo Storage</strong></p>
<ul>
<li>Store metadata in database (photo_id, user_id, caption, timestamp)</li>
<li>Store actual images in object storage (S3)</li>
<li>Use CDN for fast global delivery</li>
<li>Generate multiple sizes asynchronously</li>
</ul>
<p><strong>News Feed</strong></p>
<ul>
<li>Pre-compute feeds for active users (fanout on write)</li>
<li>On-demand generation for inactive users (fanout on read)</li>
<li>Cache recent feed items in Redis</li>
<li>Store feed in Cassandra for fast timeline queries</li>
</ul>
<p><strong>Scaling Strategy</strong></p>
<ul>
<li>Horizontal scaling for API servers</li>
<li>Database sharding by user_id</li>
<li>Read replicas for read-heavy workloads</li>
<li>Async processing for non-critical tasks</li>
</ul>
<h2 id="common-interview-questions">Common Interview Questions</h2>
<p><strong>&quot;Design a URL shortener&quot;</strong></p>
<ul>
<li>Hash function for URL → short code</li>
<li>Database to store mappings</li>
<li>Redirect service</li>
<li>Analytics tracking</li>
<li>Rate limiting</li>
</ul>
<p><strong>&quot;Design a rate limiter&quot;</strong></p>
<ul>
<li>Token bucket algorithm</li>
<li>Store counters in Redis</li>
<li>Distributed rate limiting</li>
<li>Different limits per user tier</li>
</ul>
<p><strong>&quot;Design a chat application&quot;</strong></p>
<ul>
<li>WebSocket connections for real-time</li>
<li>Message queue for reliability</li>
<li>Database for message history</li>
<li>Presence system for online status</li>
</ul>
<h2 id="monitoring-and-observability">Monitoring and Observability</h2>
<p>Essential metrics to track:</p>
<p><strong>System Metrics</strong></p>
<ul>
<li>CPU, memory, disk usage</li>
<li>Network throughput</li>
<li>Request latency (p50, p95, p99)</li>
<li>Error rates</li>
</ul>
<p><strong>Business Metrics</strong></p>
<ul>
<li>Active users</li>
<li>Request volume</li>
<li>Conversion rates</li>
<li>Revenue metrics</li>
</ul>
<p><strong>Tools</strong>: Prometheus, Grafana, DataDog, New Relic</p>
<h2 id="conclusion">Conclusion</h2>
<p>Great system design requires understanding trade-offs:</p>
<ul>
<li><strong>Consistency vs Availability</strong> (CAP theorem)</li>
<li><strong>Latency vs Throughput</strong></li>
<li><strong>Cost vs Performance</strong></li>
<li><strong>Complexity vs Simplicity</strong></li>
</ul>
<p>Start simple and scale as needed. Premature optimization is the root of all evil. Design for the current scale + one order of magnitude, then iterate based on real metrics.</p>
<p>The best system designers don't just know technologies—they understand business requirements, user needs, and how to make pragmatic trade-offs that deliver value.</p>

                
            
        </div>
    </article>
    
    <article class="post">
        <div class="post-title"><a href="https:&#x2F;&#x2F;deadkai.github.io&#x2F;docker-best-practices&#x2F;" class="post-title-link">Docker Best Practices for Production</a></div>
        <div class="post-content">
            
                
                    <p>Docker has revolutionized how we build, ship, and run applications. However, creating production-ready Docker images requires following best practices to ensure security, efficiency, and reliability.</p>
<h2 id="use-multi-stage-builds">Use Multi-Stage Builds</h2>
<p>Multi-stage builds allow you to use multiple FROM statements in your Dockerfile, keeping your final image small by excluding build dependencies:</p>
<pre data-lang="dockerfile" style="background-color:#2b303b;color:#c0c5ce;" class="language-dockerfile "><code class="language-dockerfile" data-lang="dockerfile"><span style="color:#65737e;"># Build stage
</span><span style="color:#b48ead;">FROM</span><span> node:18-alpine </span><span style="color:#b48ead;">AS </span><span style="color:#bf616a;">builder
</span><span style="color:#b48ead;">WORKDIR </span><span>/app
</span><span style="color:#b48ead;">COPY</span><span> package*.json ./
</span><span style="color:#b48ead;">RUN </span><span>npm ci
</span><span style="color:#b48ead;">COPY</span><span> . .
</span><span style="color:#b48ead;">RUN </span><span>npm run build
</span><span>
</span><span style="color:#65737e;"># Production stage
</span><span style="color:#b48ead;">FROM</span><span> node:18-alpine
</span><span style="color:#b48ead;">WORKDIR </span><span>/app
</span><span style="color:#b48ead;">COPY</span><span> --from=</span><span style="color:#bf616a;">builder</span><span> /app/dist ./dist
</span><span style="color:#b48ead;">COPY</span><span> --from=</span><span style="color:#bf616a;">builder</span><span> /app/node_modules ./node_modules
</span><span style="color:#b48ead;">EXPOSE </span><span>3000
</span><span>CMD [&quot;</span><span style="color:#a3be8c;">node</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">dist/index.js</span><span>&quot;]
</span></code></pre>
<p>This pattern reduces the final image size by 60-80% in many cases.</p>
<h2 id="optimize-layer-caching">Optimize Layer Caching</h2>
<p>Docker builds images in layers, and each instruction creates a new layer. Order your Dockerfile to maximize cache hits:</p>
<pre data-lang="dockerfile" style="background-color:#2b303b;color:#c0c5ce;" class="language-dockerfile "><code class="language-dockerfile" data-lang="dockerfile"><span style="color:#65737e;"># Good: Dependencies change less frequently than source code
</span><span>COPY package*.json ./
</span><span>RUN npm ci
</span><span>COPY . .
</span><span>
</span><span style="color:#65737e;"># Bad: Copying everything first invalidates cache on any file change
</span><span>COPY . .
</span><span>RUN npm ci
</span></code></pre>
<h2 id="use-specific-base-image-tags">Use Specific Base Image Tags</h2>
<p>Never use the <code>latest</code> tag in production:</p>
<pre data-lang="dockerfile" style="background-color:#2b303b;color:#c0c5ce;" class="language-dockerfile "><code class="language-dockerfile" data-lang="dockerfile"><span style="color:#65737e;"># Bad
</span><span style="color:#b48ead;">FROM</span><span> node:latest
</span><span>
</span><span style="color:#65737e;"># Good
</span><span style="color:#b48ead;">FROM</span><span> node:18.17.1-alpine
</span></code></pre>
<p>Specific tags ensure reproducible builds and prevent unexpected breaking changes.</p>
<h2 id="run-as-non-root-user">Run as Non-Root User</h2>
<p>Running containers as root is a security risk. Create and use a non-privileged user:</p>
<pre data-lang="dockerfile" style="background-color:#2b303b;color:#c0c5ce;" class="language-dockerfile "><code class="language-dockerfile" data-lang="dockerfile"><span style="color:#b48ead;">FROM</span><span> node:18-alpine
</span><span>
</span><span style="color:#65737e;"># Create app user
</span><span style="color:#b48ead;">RUN </span><span>addgroup -g 1001 -S nodejs &amp;&amp; \
</span><span>    adduser -S nodejs -u 1001
</span><span>
</span><span style="color:#65737e;"># Set ownership
</span><span style="color:#b48ead;">WORKDIR </span><span>/app
</span><span style="color:#b48ead;">COPY</span><span> --chown=nodejs:nodejs . .
</span><span>
</span><span style="color:#65737e;"># Switch to non-root user
</span><span style="color:#b48ead;">USER </span><span>nodejs
</span><span>
</span><span>CMD [&quot;</span><span style="color:#a3be8c;">node</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">index.js</span><span>&quot;]
</span></code></pre>
<h2 id="minimize-image-size">Minimize Image Size</h2>
<p>Smaller images mean faster deployments and reduced attack surface:</p>
<ol>
<li><strong>Use Alpine-based images</strong> when possible (node:alpine, python:alpine)</li>
<li><strong>Remove unnecessary files</strong> in the same layer they're created</li>
<li><strong>Use .dockerignore</strong> to exclude files from the build context</li>
</ol>
<pre data-lang="dockerignore" style="background-color:#2b303b;color:#c0c5ce;" class="language-dockerignore "><code class="language-dockerignore" data-lang="dockerignore"><span>node_modules
</span><span>npm-debug.log
</span><span>.git
</span><span>.env
</span><span>*.md
</span><span>tests
</span></code></pre>
<h2 id="handle-secrets-securely">Handle Secrets Securely</h2>
<p>Never hardcode secrets in Dockerfiles or images:</p>
<pre data-lang="dockerfile" style="background-color:#2b303b;color:#c0c5ce;" class="language-dockerfile "><code class="language-dockerfile" data-lang="dockerfile"><span style="color:#65737e;"># Bad
</span><span>ENV API_KEY=secret123
</span><span>
</span><span style="color:#65737e;"># Good: Use build-time secrets
</span><span>RUN --mount=type=secret,id=api_key \
</span><span>    API_KEY=$(cat /run/secrets/api_key) npm run configure
</span></code></pre>
<p>In production, use environment variables, Docker secrets, or dedicated secret management tools like Vault.</p>
<h2 id="implement-health-checks">Implement Health Checks</h2>
<p>Health checks help orchestration platforms determine if your container is functioning correctly:</p>
<pre data-lang="dockerfile" style="background-color:#2b303b;color:#c0c5ce;" class="language-dockerfile "><code class="language-dockerfile" data-lang="dockerfile"><span>HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \
</span><span>  CMD node healthcheck.js || exit 1
</span></code></pre>
<h2 id="use-entrypoint-and-cmd-correctly">Use ENTRYPOINT and CMD Correctly</h2>
<p>ENTRYPOINT defines the executable, while CMD provides default arguments:</p>
<pre data-lang="dockerfile" style="background-color:#2b303b;color:#c0c5ce;" class="language-dockerfile "><code class="language-dockerfile" data-lang="dockerfile"><span>ENTRYPOINT [&quot;node&quot;]
</span><span>CMD [&quot;index.js&quot;]
</span></code></pre>
<p>This allows users to override arguments: <code>docker run myimage server.js</code></p>
<h2 id="scan-for-vulnerabilities">Scan for Vulnerabilities</h2>
<p>Regularly scan your images for security vulnerabilities:</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#bf616a;">docker</span><span> scan myimage:latest
</span></code></pre>
<p>Tools like Trivy, Snyk, and Clair can integrate into CI/CD pipelines to catch vulnerabilities before deployment.</p>
<h2 id="log-to-stdout-stderr">Log to STDOUT/STDERR</h2>
<p>Containers should log to standard output and error streams, not files:</p>
<pre data-lang="javascript" style="background-color:#2b303b;color:#c0c5ce;" class="language-javascript "><code class="language-javascript" data-lang="javascript"><span style="color:#65737e;">// Good
</span><span style="color:#ebcb8b;">console</span><span>.</span><span style="color:#96b5b4;">log</span><span>(&#39;</span><span style="color:#a3be8c;">Server started</span><span>&#39;);
</span><span style="color:#ebcb8b;">console</span><span>.</span><span style="color:#96b5b4;">error</span><span>(&#39;</span><span style="color:#a3be8c;">Error occurred</span><span>&#39;);
</span><span>
</span><span style="color:#65737e;">// Bad (in containers)
</span><span style="color:#bf616a;">fs</span><span>.</span><span style="color:#8fa1b3;">appendFileSync</span><span>(&#39;</span><span style="color:#a3be8c;">/var/log/app.log</span><span>&#39;, &#39;</span><span style="color:#a3be8c;">Server started</span><span>&#39;);
</span></code></pre>
<p>This integrates with Docker's logging drivers and centralized logging solutions.</p>
<h2 id="conclusion">Conclusion</h2>
<p>Following these best practices will result in Docker images that are secure, efficient, and production-ready. The key principles are:</p>
<ul>
<li>Keep images small</li>
<li>Optimize for caching</li>
<li>Follow security best practices</li>
<li>Make containers observable</li>
<li>Ensure reproducibility</li>
</ul>
<p>By investing time in proper Dockerization, you'll save countless hours in debugging, security incidents, and deployment issues.</p>

                
            
        </div>
    </article>
    
    <article class="post">
        <div class="post-title"><a href="https:&#x2F;&#x2F;deadkai.github.io&#x2F;git-rebase-vs-merge&#x2F;" class="post-title-link">Git Rebase vs Merge: When to Use Each</a></div>
        <div class="post-content">
            
                
                    <p>One of the most debated topics in Git workflows is whether to use <code>git merge</code> or <code>git rebase</code>. Both accomplish the same goal—integrating changes from one branch into another—but they do so in fundamentally different ways.</p>
<h2 id="understanding-git-merge">Understanding Git Merge</h2>
<p>Merge creates a new &quot;merge commit&quot; that ties together the histories of both branches:</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#bf616a;">git</span><span> checkout main
</span><span style="color:#bf616a;">git</span><span> merge feature-branch
</span></code></pre>
<p>This creates a commit with two parents, preserving the complete history of both branches.</p>
<h3 id="advantages-of-merge">Advantages of Merge</h3>
<ul>
<li><strong>Preserves complete history</strong>: Every commit remains exactly as it was created</li>
<li><strong>Non-destructive</strong>: Doesn't change existing commits</li>
<li><strong>Clear feature boundaries</strong>: Easy to see when features were integrated</li>
<li><strong>Safe for public branches</strong>: No risk of rewriting shared history</li>
</ul>
<h3 id="disadvantages-of-merge">Disadvantages of Merge</h3>
<ul>
<li><strong>Cluttered history</strong>: Many merge commits can make history hard to follow</li>
<li><strong>Confusing graph</strong>: Complex branching patterns emerge in active repositories</li>
<li><strong>Polluted logs</strong>: <code>git log</code> output becomes verbose and harder to read</li>
</ul>
<h2 id="understanding-git-rebase">Understanding Git Rebase</h2>
<p>Rebase rewrites commits from one branch onto another, creating a linear history:</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#bf616a;">git</span><span> checkout feature-branch
</span><span style="color:#bf616a;">git</span><span> rebase main
</span></code></pre>
<p>This replays your feature commits on top of main, creating new commits with different hashes.</p>
<h3 id="advantages-of-rebase">Advantages of Rebase</h3>
<ul>
<li><strong>Clean, linear history</strong>: Makes project history much easier to follow</li>
<li><strong>Simplified logs</strong>: <code>git log</code> output is straightforward and readable</li>
<li><strong>Easier bisecting</strong>: Finding bugs with <code>git bisect</code> is more efficient</li>
<li><strong>Professional commits</strong>: Opportunity to clean up commit history before merging</li>
</ul>
<h3 id="disadvantages-of-rebase">Disadvantages of Rebase</h3>
<ul>
<li><strong>Rewrites history</strong>: Changes commit hashes, which can be dangerous</li>
<li><strong>Requires force pushing</strong>: Can overwrite others' work if not careful</li>
<li><strong>Conflicts can be tedious</strong>: May need to resolve the same conflict multiple times</li>
<li><strong>Loses context</strong>: When a feature was actually developed becomes unclear</li>
</ul>
<h2 id="the-golden-rule-of-rebasing">The Golden Rule of Rebasing</h2>
<p><strong>Never rebase commits that have been pushed to a public repository and that others might have based work on.</strong></p>
<p>Rebasing rewrites history. If others have based work on your commits, rebasing will create divergent histories and cause serious problems.</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#65737e;"># Safe: Rebasing local commits not yet pushed
</span><span style="color:#bf616a;">git</span><span> rebase main
</span><span>
</span><span style="color:#65737e;"># Dangerous: Rebasing commits others might have pulled
</span><span style="color:#bf616a;">git</span><span> rebase main  </span><span style="color:#65737e;"># on a shared feature branch
</span><span style="color:#bf616a;">git</span><span> push</span><span style="color:#bf616a;"> --force  </span><span style="color:#65737e;"># DON&#39;T DO THIS on shared branches!
</span></code></pre>
<h2 id="recommended-workflow">Recommended Workflow</h2>
<p>Here's a practical approach that combines both strategies:</p>
<h3 id="for-feature-branches">For Feature Branches</h3>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#65737e;"># While developing, rebase frequently to stay up-to-date
</span><span style="color:#bf616a;">git</span><span> fetch origin
</span><span style="color:#bf616a;">git</span><span> rebase origin/main
</span><span>
</span><span style="color:#65737e;"># Clean up your commits before merging
</span><span style="color:#bf616a;">git</span><span> rebase</span><span style="color:#bf616a;"> -i</span><span> origin/main
</span><span>
</span><span style="color:#65737e;"># When ready to merge into main
</span><span style="color:#bf616a;">git</span><span> checkout main
</span><span style="color:#bf616a;">git</span><span> merge feature-branch</span><span style="color:#bf616a;"> --no-ff
</span></code></pre>
<h3 id="interactive-rebase-for-cleanup">Interactive Rebase for Cleanup</h3>
<p>Before merging, clean up your commit history:</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#bf616a;">git</span><span> rebase</span><span style="color:#bf616a;"> -i</span><span> HEAD</span><span style="color:#bf616a;">~</span><span>5
</span></code></pre>
<p>This allows you to:</p>
<ul>
<li><strong>Squash</strong> related commits together</li>
<li><strong>Reword</strong> commit messages for clarity</li>
<li><strong>Reorder</strong> commits logically</li>
<li><strong>Drop</strong> commits that aren't needed</li>
</ul>
<h2 id="common-scenarios">Common Scenarios</h2>
<h3 id="scenario-1-keeping-feature-branch-updated">Scenario 1: Keeping Feature Branch Updated</h3>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#65737e;"># On feature-branch
</span><span style="color:#bf616a;">git</span><span> fetch origin
</span><span style="color:#bf616a;">git</span><span> rebase origin/main
</span></code></pre>
<p>Use rebase to keep your feature branch up-to-date with main. This keeps history clean and makes the eventual merge smooth.</p>
<h3 id="scenario-2-integrating-complete-features">Scenario 2: Integrating Complete Features</h3>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#65737e;"># On main
</span><span style="color:#bf616a;">git</span><span> merge feature-branch</span><span style="color:#bf616a;"> --no-ff
</span></code></pre>
<p>Use merge when incorporating a complete feature. The merge commit serves as documentation of when the feature was integrated.</p>
<h3 id="scenario-3-cleaning-up-before-merging">Scenario 3: Cleaning Up Before Merging</h3>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#65737e;"># On feature-branch
</span><span style="color:#bf616a;">git</span><span> rebase</span><span style="color:#bf616a;"> -i</span><span> origin/main
</span><span style="color:#65737e;"># Clean up commits
</span><span style="color:#bf616a;">git</span><span> checkout main
</span><span style="color:#bf616a;">git</span><span> merge feature-branch</span><span style="color:#bf616a;"> --no-ff
</span></code></pre>
<p>Combine both: rebase to clean up, then merge to integrate.</p>
<h2 id="team-workflow-considerations">Team Workflow Considerations</h2>
<p>Your team should agree on a strategy:</p>
<h3 id="merge-only-workflow">Merge-Only Workflow</h3>
<ul>
<li>Simple and safe</li>
<li>Good for teams new to Git</li>
<li>Preserves all history</li>
<li>Can become messy in large projects</li>
</ul>
<h3 id="rebase-only-workflow">Rebase-Only Workflow</h3>
<ul>
<li>Clean, linear history</li>
<li>Requires discipline and Git expertise</li>
<li>Works well for small, experienced teams</li>
<li>Can be dangerous without careful coordination</li>
</ul>
<h3 id="hybrid-workflow-recommended">Hybrid Workflow (Recommended)</h3>
<ul>
<li>Rebase feature branches on main to stay current</li>
<li>Squash/clean commits before integration</li>
<li>Merge feature branches into main with --no-ff</li>
<li>Never rebase public/shared branches</li>
</ul>
<h2 id="handling-conflicts">Handling Conflicts</h2>
<h3 id="during-merge">During Merge</h3>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#bf616a;">git</span><span> merge feature-branch
</span><span style="color:#65737e;"># Fix conflicts in files
</span><span style="color:#bf616a;">git</span><span> add .
</span><span style="color:#bf616a;">git</span><span> commit
</span></code></pre>
<h3 id="during-rebase">During Rebase</h3>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#bf616a;">git</span><span> rebase main
</span><span style="color:#65737e;"># Fix conflicts in files
</span><span style="color:#bf616a;">git</span><span> add .
</span><span style="color:#bf616a;">git</span><span> rebase</span><span style="color:#bf616a;"> --continue
</span><span style="color:#65737e;"># Repeat for each commit
</span></code></pre>
<p>Rebase conflicts can be more tedious since you might resolve similar conflicts multiple times.</p>
<h2 id="conclusion">Conclusion</h2>
<p>Neither merge nor rebase is universally better—they serve different purposes:</p>
<ul>
<li><strong>Use merge</strong> for integrating completed features and when preserving exact history matters</li>
<li><strong>Use rebase</strong> for keeping feature branches current and cleaning up local commits</li>
<li><strong>Never rebase</strong> commits that others might be using</li>
</ul>
<p>The key is consistency. Your team should establish and document a clear workflow that everyone follows. Understanding both tools allows you to choose the right one for each situation.</p>

                
            
        </div>
    </article>
    
    <article class="post">
        <div class="post-title"><a href="https:&#x2F;&#x2F;deadkai.github.io&#x2F;understanding-rust-ownership&#x2F;" class="post-title-link">Understanding Rust&#x27;s Ownership System</a></div>
        <div class="post-content">
            
                
                    <p>Rust's ownership system is one of its most distinctive features, enabling memory safety without garbage collection. This system is built on three key rules that the compiler enforces at compile time.</p>
<h2 id="the-three-rules-of-ownership">The Three Rules of Ownership</h2>
<ol>
<li><strong>Each value in Rust has a variable that's called its owner</strong></li>
<li><strong>There can only be one owner at a time</strong></li>
<li><strong>When the owner goes out of scope, the value will be dropped</strong></li>
</ol>
<h2 id="why-ownership-matters">Why Ownership Matters</h2>
<p>Traditional systems programming languages like C and C++ require manual memory management, leading to common bugs like use-after-free, double-free, and memory leaks. Garbage-collected languages solve this but introduce runtime overhead and unpredictable pause times.</p>
<p>Rust's ownership system provides a third way: memory safety guarantees at compile time with zero runtime cost.</p>
<h2 id="ownership-in-practice">Ownership in Practice</h2>
<pre data-lang="rust" style="background-color:#2b303b;color:#c0c5ce;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">main</span><span>() {
</span><span>    </span><span style="color:#b48ead;">let</span><span> s1 = String::from(&quot;</span><span style="color:#a3be8c;">hello</span><span>&quot;);
</span><span>    </span><span style="color:#b48ead;">let</span><span> s2 = s1; </span><span style="color:#65737e;">// s1 is moved to s2
</span><span>
</span><span>    </span><span style="color:#65737e;">// println!(&quot;{}&quot;, s1); // This would error! s1 is no longer valid
</span><span>    println!(&quot;</span><span style="color:#d08770;">{}</span><span>&quot;, s2); </span><span style="color:#65737e;">// This works fine
</span><span>}
</span></code></pre>
<p>When <code>s1</code> is assigned to <code>s2</code>, Rust doesn't copy the data. Instead, it moves ownership from <code>s1</code> to <code>s2</code>. This prevents double-free errors when both variables go out of scope.</p>
<h2 id="borrowing-and-references">Borrowing and References</h2>
<p>To use a value without taking ownership, Rust provides borrowing through references:</p>
<pre data-lang="rust" style="background-color:#2b303b;color:#c0c5ce;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">calculate_length</span><span>(</span><span style="color:#bf616a;">s</span><span>: &amp;String) -&gt; </span><span style="color:#b48ead;">usize </span><span>{
</span><span>    s.</span><span style="color:#96b5b4;">len</span><span>()
</span><span>} </span><span style="color:#65737e;">// s goes out of scope, but since it doesn&#39;t own the data, nothing happens
</span><span>
</span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">main</span><span>() {
</span><span>    </span><span style="color:#b48ead;">let</span><span> s1 = String::from(&quot;</span><span style="color:#a3be8c;">hello</span><span>&quot;);
</span><span>    </span><span style="color:#b48ead;">let</span><span> len = </span><span style="color:#96b5b4;">calculate_length</span><span>(&amp;s1);
</span><span>    println!(&quot;</span><span style="color:#a3be8c;">Length of &#39;</span><span style="color:#d08770;">{}</span><span style="color:#a3be8c;">&#39; is </span><span style="color:#d08770;">{}</span><span style="color:#a3be8c;">.</span><span>&quot;, s1, len);
</span><span>}
</span></code></pre>
<p>The <code>&amp;</code> symbol creates a reference, allowing the function to borrow the value without taking ownership.</p>
<h2 id="mutable-references">Mutable References</h2>
<p>References are immutable by default, but you can create mutable references:</p>
<pre data-lang="rust" style="background-color:#2b303b;color:#c0c5ce;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">main</span><span>() {
</span><span>    </span><span style="color:#b48ead;">let mut</span><span> s = String::from(&quot;</span><span style="color:#a3be8c;">hello</span><span>&quot;);
</span><span>    </span><span style="color:#96b5b4;">change</span><span>(&amp;</span><span style="color:#b48ead;">mut</span><span> s);
</span><span>}
</span><span>
</span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">change</span><span>(</span><span style="color:#bf616a;">s</span><span>: &amp;</span><span style="color:#b48ead;">mut</span><span> String) {
</span><span>    s.</span><span style="color:#96b5b4;">push_str</span><span>(&quot;</span><span style="color:#a3be8c;">, world</span><span>&quot;);
</span><span>}
</span></code></pre>
<p>However, Rust enforces a crucial restriction: you can have either one mutable reference OR any number of immutable references at a time, but not both. This prevents data races at compile time.</p>
<h2 id="the-lifetime-system">The Lifetime System</h2>
<p>Lifetimes are Rust's way of ensuring that references are always valid. The compiler uses lifetime annotations to verify that references don't outlive the data they point to:</p>
<pre data-lang="rust" style="background-color:#2b303b;color:#c0c5ce;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">longest</span><span>&lt;</span><span style="color:#b48ead;">&#39;a</span><span>&gt;(</span><span style="color:#bf616a;">x</span><span>: &amp;</span><span style="color:#b48ead;">&#39;a str</span><span>, </span><span style="color:#bf616a;">y</span><span>: &amp;</span><span style="color:#b48ead;">&#39;a str</span><span>) -&gt; &amp;</span><span style="color:#b48ead;">&#39;a str </span><span>{
</span><span>    </span><span style="color:#b48ead;">if</span><span> x.</span><span style="color:#96b5b4;">len</span><span>() &gt; y.</span><span style="color:#96b5b4;">len</span><span>() {
</span><span>        x
</span><span>    } </span><span style="color:#b48ead;">else </span><span>{
</span><span>        y
</span><span>    }
</span><span>}
</span></code></pre>
<p>The <code>'a</code> annotation tells Rust that the returned reference will be valid as long as both input references are valid.</p>
<h2 id="conclusion">Conclusion</h2>
<p>Rust's ownership system might seem complex at first, but it provides powerful guarantees that eliminate entire categories of bugs. By understanding these concepts, you can write safe, concurrent code without the overhead of garbage collection.</p>
<p>The learning curve is steep, but the payoff is substantial: fearless concurrency and memory safety guaranteed at compile time.</p>

                
            
        </div>
    </article>
    

</section>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>


    </main>
    
    <p class="license"></p>
    
</body>
</html>
